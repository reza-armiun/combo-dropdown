{"ast":null,"code":"import { combineLatest, of } from \"rxjs\";\nimport { switchMap, tap } from \"rxjs/operators\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../dropdown.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"../dropdown-segment/dropdown-segment.component\";\n\nconst _c0 = function () {\n  return [];\n};\n\nfunction DropdownSegmentsWrapperComponent_ng_container_1_ng_container_1_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelement(1, \"app-dropdown-segment\", 3);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const combo_r4 = ctx.$implicit;\n    const filteredList_r2 = i0.ɵɵnextContext().ngIf;\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    let tmp_1_0;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"comboComponent\", combo_r4)(\"dataList\", (tmp_1_0 = ctx_r3.getItemsByType(filteredList_r2.items, combo_r4.getType())) !== null && tmp_1_0 !== undefined ? tmp_1_0 : i0.ɵɵpureFunction0(2, _c0));\n  }\n}\n\nfunction DropdownSegmentsWrapperComponent_ng_container_1_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, DropdownSegmentsWrapperComponent_ng_container_1_ng_container_1_div_1_Template, 2, 3, \"div\", 2);\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    let tmp_0_0;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", (tmp_0_0 = ctx_r1.comboComponents) !== null && tmp_0_0 !== undefined ? tmp_0_0 : i0.ɵɵpureFunction0(1, _c0));\n  }\n}\n\nfunction DropdownSegmentsWrapperComponent_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, DropdownSegmentsWrapperComponent_ng_container_1_ng_container_1_Template, 2, 2, \"ng-container\", 1);\n    i0.ɵɵpipe(2, \"async\");\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(2, 1, ctx_r0.list$));\n  }\n}\n\nexport class DropdownSegmentsWrapperComponent {\n  constructor(dropdownService) {\n    this.dropdownService = dropdownService;\n    this.comboComponents = [];\n    this.dataList$ = dropdownService.dataList$;\n    this.search$ = dropdownService.search;\n  }\n\n  ngOnInit() {}\n\n  ngOnChanges(changes) {\n    var _a;\n\n    if ((_a = this.comboComponents) === null || _a === void 0 ? void 0 : _a.length) {\n      this.list$ = this.getList();\n    }\n  }\n\n  getList() {\n    var _a;\n\n    if (!((_a = this.comboComponents) === null || _a === void 0 ? void 0 : _a.length)) return of({\n      items: [],\n      search: {\n        searchString: '',\n        key: ''\n      }\n    });\n    return combineLatest([this.dataList$, this.search$]).pipe(switchMap(([items, search]) => {\n      if (!search.searchString.length) {\n        let result = {\n          items: items,\n          search\n        };\n        return of(result);\n      }\n\n      let filterList = items.filter(item => {\n        var _a, _b;\n\n        let comboComp = (_a = this.comboComponents) === null || _a === void 0 ? void 0 : _a.find(combo => combo.getType().name == item.__type); // @ts-ignore\n\n        if (comboComp) return (_b = item[comboComp.getSelectValue()]) === null || _b === void 0 ? void 0 : _b.toString().includes(search.searchString);\n      });\n      let filteredResult = {\n        items: search.searchString.length > 0 ? filterList : items,\n        search\n      };\n      return of(filteredResult);\n    }), tap(({\n      items,\n      search\n    }) => {\n      var _a;\n\n      if (items.length == 1) {\n        let item = items[0];\n        let comboComp = (_a = this.comboComponents) === null || _a === void 0 ? void 0 : _a.find(combo => combo.getType().name == item.__type);\n\n        if (comboComp && search.key) {\n          let selectedItem = {\n            inputStr: item[comboComp.getSelectValue()],\n            item: item\n          };\n          this.dropdownService.selectItem(selectedItem);\n        }\n      }\n    }));\n  }\n\n  getItemsByType(filteredList, type) {\n    if (!(filteredList === null || filteredList === void 0 ? void 0 : filteredList.length)) return [];\n    return filteredList.filter(item => item.__type == type.name);\n  }\n\n}\n\nDropdownSegmentsWrapperComponent.ɵfac = function DropdownSegmentsWrapperComponent_Factory(t) {\n  return new (t || DropdownSegmentsWrapperComponent)(i0.ɵɵdirectiveInject(i1.DropdownService));\n};\n\nDropdownSegmentsWrapperComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: DropdownSegmentsWrapperComponent,\n  selectors: [[\"app-dropdown-segments-wrapper\"]],\n  inputs: {\n    comboComponents: [\"combos\", \"comboComponents\"]\n  },\n  features: [i0.ɵɵNgOnChangesFeature],\n  decls: 3,\n  vars: 3,\n  consts: [[1, \"container\"], [4, \"ngIf\"], [4, \"ngFor\", \"ngForOf\"], [3, \"comboComponent\", \"dataList\"]],\n  template: function DropdownSegmentsWrapperComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵtemplate(1, DropdownSegmentsWrapperComponent_ng_container_1_Template, 3, 3, \"ng-container\", 1);\n      i0.ɵɵpipe(2, \"async\");\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(2, 1, ctx.list$));\n    }\n  },\n  directives: [i2.NgIf, i2.NgForOf, i3.DropdownSegmentComponent],\n  pipes: [i2.AsyncPipe],\n  styles: [\".container[_ngcontent-%COMP%] {\\n  max-width: 350px;\\n  max-height: 500px;\\n  overflow-y: auto;\\n  box-shadow: 1px 1px 8px -1px rgba(128, 128, 128, 0.4);\\n  border-radius: 4px;\\n  position: relative;\\n  z-index: 20;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRyb3Bkb3duLXNlZ21lbnRzLXdyYXBwZXIuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGdCQUFnQjtFQUNoQixpQkFBaUI7RUFDakIsZ0JBQWdCO0VBQ2hCLHFEQUFxRDtFQUNyRCxrQkFBa0I7RUFDbEIsa0JBQWtCO0VBQ2xCLFdBQVc7QUFDYiIsImZpbGUiOiJkcm9wZG93bi1zZWdtZW50cy13cmFwcGVyLmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuY29udGFpbmVyIHtcbiAgbWF4LXdpZHRoOiAzNTBweDtcbiAgbWF4LWhlaWdodDogNTAwcHg7XG4gIG92ZXJmbG93LXk6IGF1dG87XG4gIGJveC1zaGFkb3c6IDFweCAxcHggOHB4IC0xcHggcmdiYSgxMjgsIDEyOCwgMTI4LCAwLjQpO1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgei1pbmRleDogMjA7XG59XG4iXX0= */\"]\n});","map":{"version":3,"sources":["/Users/razearmin/Desktop/combo-dropdown/src/app/dropdown/dropdown-segments-wrapper/dropdown-segments-wrapper.component.ts"],"names":["combineLatest","of","switchMap","tap","i0","i1","i2","i3","_c0","DropdownSegmentsWrapperComponent_ng_container_1_ng_container_1_div_1_Template","rf","ctx","ɵɵelementStart","ɵɵelement","ɵɵelementEnd","combo_r4","$implicit","filteredList_r2","ɵɵnextContext","ngIf","ctx_r3","tmp_1_0","ɵɵadvance","ɵɵproperty","getItemsByType","items","getType","undefined","ɵɵpureFunction0","DropdownSegmentsWrapperComponent_ng_container_1_ng_container_1_Template","ɵɵelementContainerStart","ɵɵtemplate","ɵɵelementContainerEnd","ctx_r1","tmp_0_0","comboComponents","DropdownSegmentsWrapperComponent_ng_container_1_Template","ɵɵpipe","ctx_r0","ɵɵpipeBind1","list$","DropdownSegmentsWrapperComponent","constructor","dropdownService","dataList$","search$","search","ngOnInit","ngOnChanges","changes","_a","length","getList","searchString","key","pipe","result","filterList","filter","item","_b","comboComp","find","combo","name","__type","getSelectValue","toString","includes","filteredResult","selectedItem","inputStr","selectItem","filteredList","type","ɵfac","DropdownSegmentsWrapperComponent_Factory","t","ɵɵdirectiveInject","DropdownService","ɵcmp","ɵɵdefineComponent","selectors","inputs","features","ɵɵNgOnChangesFeature","decls","vars","consts","template","DropdownSegmentsWrapperComponent_Template","directives","NgIf","NgForOf","DropdownSegmentComponent","pipes","AsyncPipe","styles"],"mappings":"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","sourcesContent":["import { combineLatest, of } from \"rxjs\";\nimport { switchMap, tap, } from \"rxjs/operators\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../dropdown.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"../dropdown-segment/dropdown-segment.component\";\nconst _c0 = function () { return []; };\nfunction DropdownSegmentsWrapperComponent_ng_container_1_ng_container_1_div_1_Template(rf, ctx) { if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelement(1, \"app-dropdown-segment\", 3);\n    i0.ɵɵelementEnd();\n} if (rf & 2) {\n    const combo_r4 = ctx.$implicit;\n    const filteredList_r2 = i0.ɵɵnextContext().ngIf;\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    let tmp_1_0;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"comboComponent\", combo_r4)(\"dataList\", (tmp_1_0 = ctx_r3.getItemsByType(filteredList_r2.items, combo_r4.getType())) !== null && tmp_1_0 !== undefined ? tmp_1_0 : i0.ɵɵpureFunction0(2, _c0));\n} }\nfunction DropdownSegmentsWrapperComponent_ng_container_1_ng_container_1_Template(rf, ctx) { if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, DropdownSegmentsWrapperComponent_ng_container_1_ng_container_1_div_1_Template, 2, 3, \"div\", 2);\n    i0.ɵɵelementContainerEnd();\n} if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    let tmp_0_0;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", (tmp_0_0 = ctx_r1.comboComponents) !== null && tmp_0_0 !== undefined ? tmp_0_0 : i0.ɵɵpureFunction0(1, _c0));\n} }\nfunction DropdownSegmentsWrapperComponent_ng_container_1_Template(rf, ctx) { if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, DropdownSegmentsWrapperComponent_ng_container_1_ng_container_1_Template, 2, 2, \"ng-container\", 1);\n    i0.ɵɵpipe(2, \"async\");\n    i0.ɵɵelementContainerEnd();\n} if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(2, 1, ctx_r0.list$));\n} }\nexport class DropdownSegmentsWrapperComponent {\n    constructor(dropdownService) {\n        this.dropdownService = dropdownService;\n        this.comboComponents = [];\n        this.dataList$ = dropdownService.dataList$;\n        this.search$ = dropdownService.search;\n    }\n    ngOnInit() {\n    }\n    ngOnChanges(changes) {\n        var _a;\n        if ((_a = this.comboComponents) === null || _a === void 0 ? void 0 : _a.length) {\n            this.list$ = this.getList();\n        }\n    }\n    getList() {\n        var _a;\n        if (!((_a = this.comboComponents) === null || _a === void 0 ? void 0 : _a.length))\n            return of({ items: [], search: { searchString: '', key: '' } });\n        return combineLatest([this.dataList$, this.search$])\n            .pipe(switchMap(([items, search]) => {\n            if (!search.searchString.length) {\n                let result = { items: items, search };\n                return of(result);\n            }\n            let filterList = items.filter(item => {\n                var _a, _b;\n                let comboComp = (_a = this.comboComponents) === null || _a === void 0 ? void 0 : _a.find(combo => combo.getType().name == item.__type);\n                // @ts-ignore\n                if (comboComp)\n                    return (_b = item[comboComp.getSelectValue()]) === null || _b === void 0 ? void 0 : _b.toString().includes(search.searchString);\n            });\n            let filteredResult = { items: search.searchString.length > 0 ? filterList : items, search };\n            return of(filteredResult);\n        }), tap(({ items, search }) => {\n            var _a;\n            if (items.length == 1) {\n                let item = items[0];\n                let comboComp = (_a = this.comboComponents) === null || _a === void 0 ? void 0 : _a.find(combo => combo.getType().name == item.__type);\n                if (comboComp && search.key) {\n                    let selectedItem = { inputStr: item[comboComp.getSelectValue()], item: item };\n                    this.dropdownService.selectItem(selectedItem);\n                }\n            }\n        }));\n    }\n    getItemsByType(filteredList, type) {\n        if (!(filteredList === null || filteredList === void 0 ? void 0 : filteredList.length))\n            return [];\n        return filteredList\n            .filter(item => item.__type == type.name);\n    }\n}\nDropdownSegmentsWrapperComponent.ɵfac = function DropdownSegmentsWrapperComponent_Factory(t) { return new (t || DropdownSegmentsWrapperComponent)(i0.ɵɵdirectiveInject(i1.DropdownService)); };\nDropdownSegmentsWrapperComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: DropdownSegmentsWrapperComponent, selectors: [[\"app-dropdown-segments-wrapper\"]], inputs: { comboComponents: [\"combos\", \"comboComponents\"] }, features: [i0.ɵɵNgOnChangesFeature], decls: 3, vars: 3, consts: [[1, \"container\"], [4, \"ngIf\"], [4, \"ngFor\", \"ngForOf\"], [3, \"comboComponent\", \"dataList\"]], template: function DropdownSegmentsWrapperComponent_Template(rf, ctx) { if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵtemplate(1, DropdownSegmentsWrapperComponent_ng_container_1_Template, 3, 3, \"ng-container\", 1);\n        i0.ɵɵpipe(2, \"async\");\n        i0.ɵɵelementEnd();\n    } if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(2, 1, ctx.list$));\n    } }, directives: [i2.NgIf, i2.NgForOf, i3.DropdownSegmentComponent], pipes: [i2.AsyncPipe], styles: [\".container[_ngcontent-%COMP%] {\\n  max-width: 350px;\\n  max-height: 500px;\\n  overflow-y: auto;\\n  box-shadow: 1px 1px 8px -1px rgba(128, 128, 128, 0.4);\\n  border-radius: 4px;\\n  position: relative;\\n  z-index: 20;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRyb3Bkb3duLXNlZ21lbnRzLXdyYXBwZXIuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGdCQUFnQjtFQUNoQixpQkFBaUI7RUFDakIsZ0JBQWdCO0VBQ2hCLHFEQUFxRDtFQUNyRCxrQkFBa0I7RUFDbEIsa0JBQWtCO0VBQ2xCLFdBQVc7QUFDYiIsImZpbGUiOiJkcm9wZG93bi1zZWdtZW50cy13cmFwcGVyLmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuY29udGFpbmVyIHtcbiAgbWF4LXdpZHRoOiAzNTBweDtcbiAgbWF4LWhlaWdodDogNTAwcHg7XG4gIG92ZXJmbG93LXk6IGF1dG87XG4gIGJveC1zaGFkb3c6IDFweCAxcHggOHB4IC0xcHggcmdiYSgxMjgsIDEyOCwgMTI4LCAwLjQpO1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgei1pbmRleDogMjA7XG59XG4iXX0= */\"] });\n"]},"metadata":{},"sourceType":"module"}