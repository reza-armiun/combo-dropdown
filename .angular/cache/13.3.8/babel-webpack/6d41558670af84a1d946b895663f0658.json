{"ast":null,"code":"import { combineLatest, of } from \"rxjs\";\nimport { switchMap, tap } from \"rxjs/operators\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../dropdown.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"../dropdown-segment/dropdown-segment.component\";\n\nconst _c0 = function () {\n  return [];\n};\n\nfunction DropdownSegmentsWrapperComponent_ng_container_1_div_1_app_dropdown_segment_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-dropdown-segment\", 4);\n  }\n\n  if (rf & 2) {\n    const combo_r3 = i0.ɵɵnextContext().$implicit;\n    const filteredList_r1 = i0.ɵɵnextContext().ngIf;\n    const ctx_r4 = i0.ɵɵnextContext();\n    let tmp_1_0;\n    i0.ɵɵproperty(\"comboComponent\", combo_r3)(\"dataList\", (tmp_1_0 = ctx_r4.getItemsByType(filteredList_r1.items, combo_r3.getType())) !== null && tmp_1_0 !== undefined ? tmp_1_0 : i0.ɵɵpureFunction0(2, _c0));\n  }\n}\n\nfunction DropdownSegmentsWrapperComponent_ng_container_1_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, DropdownSegmentsWrapperComponent_ng_container_1_div_1_app_dropdown_segment_1_Template, 1, 3, \"app-dropdown-segment\", 3);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const combo_r3 = ctx.$implicit;\n    const filteredList_r1 = i0.ɵɵnextContext().ngIf;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.getItemsByType(filteredList_r1.items, combo_r3.getType()).length > 0);\n  }\n}\n\nfunction DropdownSegmentsWrapperComponent_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, DropdownSegmentsWrapperComponent_ng_container_1_div_1_Template, 2, 1, \"div\", 2);\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    let tmp_0_0;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", (tmp_0_0 = ctx_r0.comboComponents) !== null && tmp_0_0 !== undefined ? tmp_0_0 : i0.ɵɵpureFunction0(1, _c0));\n  }\n}\n\nexport class DropdownSegmentsWrapperComponent {\n  constructor(dropdownService) {\n    this.dropdownService = dropdownService;\n    this.comboComponents = [];\n    this.dataList$ = dropdownService.dataList$;\n    this.search$ = dropdownService.search;\n  }\n\n  ngOnInit() {}\n\n  ngOnChanges(changes) {\n    var _a;\n\n    if ((_a = this.comboComponents) === null || _a === void 0 ? void 0 : _a.length) {\n      this.filteredList$ = this.getList();\n    }\n  }\n\n  getList() {\n    var _a;\n\n    if (!((_a = this.comboComponents) === null || _a === void 0 ? void 0 : _a.length)) return of({\n      items: [],\n      search: {\n        searchString: '',\n        key: ''\n      }\n    });\n    return combineLatest([this.dataList$, this.search$]).pipe(switchMap(([items, search]) => {\n      if (!search.searchString) {\n        let result = {\n          items: items,\n          search\n        };\n        return of(result);\n      }\n\n      let filterList = items.filter(item => {\n        var _a, _b;\n\n        let comboComp = (_a = this.comboComponents) === null || _a === void 0 ? void 0 : _a.find(combo => combo.getType().name == item.__type); // @ts-ignore\n\n        if (comboComp) return (_b = item[comboComp.getSelectValue()]) === null || _b === void 0 ? void 0 : _b.toString().includes(search.searchString);\n      });\n      let filteredResult = {\n        items: search.searchString.length > 0 ? filterList : items,\n        search\n      };\n      return of(filteredResult);\n    }), tap(({\n      items,\n      search\n    }) => {\n      var _a;\n\n      if (items.length == 1) {\n        let item = items[0];\n        let comboComp = (_a = this.comboComponents) === null || _a === void 0 ? void 0 : _a.find(combo => combo.getType().name == item.__type);\n\n        if (comboComp && search.key) {\n          let selectedItem = {\n            inputStr: item[comboComp.getSelectValue()],\n            item: item\n          };\n          this.dropdownService.selectItem(selectedItem);\n        }\n      }\n    }));\n  }\n\n  getItemsByType(filteredList, type) {\n    if (!(filteredList === null || filteredList === void 0 ? void 0 : filteredList.length)) return [];\n    return filteredList.filter(item => item.__type == type.name);\n  }\n\n}\n\nDropdownSegmentsWrapperComponent.ɵfac = function DropdownSegmentsWrapperComponent_Factory(t) {\n  return new (t || DropdownSegmentsWrapperComponent)(i0.ɵɵdirectiveInject(i1.DropdownService));\n};\n\nDropdownSegmentsWrapperComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: DropdownSegmentsWrapperComponent,\n  selectors: [[\"app-dropdown-segments-wrapper\"]],\n  inputs: {\n    comboComponents: [\"combos\", \"comboComponents\"]\n  },\n  features: [i0.ɵɵNgOnChangesFeature],\n  decls: 3,\n  vars: 3,\n  consts: [[1, \"container\"], [4, \"ngIf\"], [4, \"ngFor\", \"ngForOf\"], [3, \"comboComponent\", \"dataList\", 4, \"ngIf\"], [3, \"comboComponent\", \"dataList\"]],\n  template: function DropdownSegmentsWrapperComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵtemplate(1, DropdownSegmentsWrapperComponent_ng_container_1_Template, 2, 2, \"ng-container\", 1);\n      i0.ɵɵpipe(2, \"async\");\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(2, 1, ctx.filteredList$));\n    }\n  },\n  directives: [i2.NgIf, i2.NgForOf, i3.DropdownSegmentComponent],\n  pipes: [i2.AsyncPipe],\n  styles: [\".container[_ngcontent-%COMP%] {\\n  width: 350px;\\n  max-width: 550px;\\n  max-height: 500px;\\n  overflow-y: auto;\\n  box-shadow: 1px 1px 8px -1px rgba(128, 128, 128, 0.4);\\n  border-radius: 4px;\\n  position: relative;\\n  z-index: 20;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRyb3Bkb3duLXNlZ21lbnRzLXdyYXBwZXIuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLFlBQVk7RUFDWixnQkFBZ0I7RUFDaEIsaUJBQWlCO0VBQ2pCLGdCQUFnQjtFQUNoQixxREFBcUQ7RUFDckQsa0JBQWtCO0VBQ2xCLGtCQUFrQjtFQUNsQixXQUFXO0FBQ2IiLCJmaWxlIjoiZHJvcGRvd24tc2VnbWVudHMtd3JhcHBlci5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmNvbnRhaW5lciB7XG4gIHdpZHRoOiAzNTBweDtcbiAgbWF4LXdpZHRoOiA1NTBweDtcbiAgbWF4LWhlaWdodDogNTAwcHg7XG4gIG92ZXJmbG93LXk6IGF1dG87XG4gIGJveC1zaGFkb3c6IDFweCAxcHggOHB4IC0xcHggcmdiYSgxMjgsIDEyOCwgMTI4LCAwLjQpO1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgei1pbmRleDogMjA7XG59XG4iXX0= */\"]\n});","map":{"version":3,"sources":["/Users/razearmin/Desktop/combo-dropdown/src/app/dropdown/dropdown-segments-wrapper/dropdown-segments-wrapper.component.ts"],"names":["combineLatest","of","switchMap","tap","i0","i1","i2","i3","_c0","DropdownSegmentsWrapperComponent_ng_container_1_div_1_app_dropdown_segment_1_Template","rf","ctx","ɵɵelement","combo_r3","ɵɵnextContext","$implicit","filteredList_r1","ngIf","ctx_r4","tmp_1_0","ɵɵproperty","getItemsByType","items","getType","undefined","ɵɵpureFunction0","DropdownSegmentsWrapperComponent_ng_container_1_div_1_Template","ɵɵelementStart","ɵɵtemplate","ɵɵelementEnd","ctx_r2","ɵɵadvance","length","DropdownSegmentsWrapperComponent_ng_container_1_Template","ɵɵelementContainerStart","ɵɵelementContainerEnd","ctx_r0","tmp_0_0","comboComponents","DropdownSegmentsWrapperComponent","constructor","dropdownService","dataList$","search$","search","ngOnInit","ngOnChanges","changes","_a","filteredList$","getList","searchString","key","pipe","result","filterList","filter","item","_b","comboComp","find","combo","name","__type","getSelectValue","toString","includes","filteredResult","selectedItem","inputStr","selectItem","filteredList","type","ɵfac","DropdownSegmentsWrapperComponent_Factory","t","ɵɵdirectiveInject","DropdownService","ɵcmp","ɵɵdefineComponent","selectors","inputs","features","ɵɵNgOnChangesFeature","decls","vars","consts","template","DropdownSegmentsWrapperComponent_Template","ɵɵpipe","ɵɵpipeBind1","directives","NgIf","NgForOf","DropdownSegmentComponent","pipes","AsyncPipe","styles"],"mappings":"AAAA,SAASA,aAAT,EAAwBC,EAAxB,QAAkC,MAAlC;AACA,SAASC,SAAT,EAAoBC,GAApB,QAAgC,gBAAhC;AACA,OAAO,KAAKC,EAAZ,MAAoB,eAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,qBAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,iBAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,gDAApB;;AACA,MAAMC,GAAG,GAAG,YAAY;AAAE,SAAO,EAAP;AAAY,CAAtC;;AACA,SAASC,qFAAT,CAA+FC,EAA/F,EAAmGC,GAAnG,EAAwG;AAAE,MAAID,EAAE,GAAG,CAAT,EAAY;AAClHN,IAAAA,EAAE,CAACQ,SAAH,CAAa,CAAb,EAAgB,sBAAhB,EAAwC,CAAxC;AACH;;AAAC,MAAIF,EAAE,GAAG,CAAT,EAAY;AACV,UAAMG,QAAQ,GAAGT,EAAE,CAACU,aAAH,GAAmBC,SAApC;AACA,UAAMC,eAAe,GAAGZ,EAAE,CAACU,aAAH,GAAmBG,IAA3C;AACA,UAAMC,MAAM,GAAGd,EAAE,CAACU,aAAH,EAAf;AACA,QAAIK,OAAJ;AACAf,IAAAA,EAAE,CAACgB,UAAH,CAAc,gBAAd,EAAgCP,QAAhC,EAA0C,UAA1C,EAAsD,CAACM,OAAO,GAAGD,MAAM,CAACG,cAAP,CAAsBL,eAAe,CAACM,KAAtC,EAA6CT,QAAQ,CAACU,OAAT,EAA7C,CAAX,MAAiF,IAAjF,IAAyFJ,OAAO,KAAKK,SAArG,GAAiHL,OAAjH,GAA2Hf,EAAE,CAACqB,eAAH,CAAmB,CAAnB,EAAsBjB,GAAtB,CAAjL;AACH;AAAE;;AACH,SAASkB,8DAAT,CAAwEhB,EAAxE,EAA4EC,GAA5E,EAAiF;AAAE,MAAID,EAAE,GAAG,CAAT,EAAY;AAC3FN,IAAAA,EAAE,CAACuB,cAAH,CAAkB,CAAlB,EAAqB,KAArB;AACAvB,IAAAA,EAAE,CAACwB,UAAH,CAAc,CAAd,EAAiBnB,qFAAjB,EAAwG,CAAxG,EAA2G,CAA3G,EAA8G,sBAA9G,EAAsI,CAAtI;AACAL,IAAAA,EAAE,CAACyB,YAAH;AACH;;AAAC,MAAInB,EAAE,GAAG,CAAT,EAAY;AACV,UAAMG,QAAQ,GAAGF,GAAG,CAACI,SAArB;AACA,UAAMC,eAAe,GAAGZ,EAAE,CAACU,aAAH,GAAmBG,IAA3C;AACA,UAAMa,MAAM,GAAG1B,EAAE,CAACU,aAAH,EAAf;AACAV,IAAAA,EAAE,CAAC2B,SAAH,CAAa,CAAb;AACA3B,IAAAA,EAAE,CAACgB,UAAH,CAAc,MAAd,EAAsBU,MAAM,CAACT,cAAP,CAAsBL,eAAe,CAACM,KAAtC,EAA6CT,QAAQ,CAACU,OAAT,EAA7C,EAAiES,MAAjE,GAA0E,CAAhG;AACH;AAAE;;AACH,SAASC,wDAAT,CAAkEvB,EAAlE,EAAsEC,GAAtE,EAA2E;AAAE,MAAID,EAAE,GAAG,CAAT,EAAY;AACrFN,IAAAA,EAAE,CAAC8B,uBAAH,CAA2B,CAA3B;AACA9B,IAAAA,EAAE,CAACwB,UAAH,CAAc,CAAd,EAAiBF,8DAAjB,EAAiF,CAAjF,EAAoF,CAApF,EAAuF,KAAvF,EAA8F,CAA9F;AACAtB,IAAAA,EAAE,CAAC+B,qBAAH;AACH;;AAAC,MAAIzB,EAAE,GAAG,CAAT,EAAY;AACV,UAAM0B,MAAM,GAAGhC,EAAE,CAACU,aAAH,EAAf;AACA,QAAIuB,OAAJ;AACAjC,IAAAA,EAAE,CAAC2B,SAAH,CAAa,CAAb;AACA3B,IAAAA,EAAE,CAACgB,UAAH,CAAc,SAAd,EAAyB,CAACiB,OAAO,GAAGD,MAAM,CAACE,eAAlB,MAAuC,IAAvC,IAA+CD,OAAO,KAAKb,SAA3D,GAAuEa,OAAvE,GAAiFjC,EAAE,CAACqB,eAAH,CAAmB,CAAnB,EAAsBjB,GAAtB,CAA1G;AACH;AAAE;;AACH,OAAO,MAAM+B,gCAAN,CAAuC;AAC1CC,EAAAA,WAAW,CAACC,eAAD,EAAkB;AACzB,SAAKA,eAAL,GAAuBA,eAAvB;AACA,SAAKH,eAAL,GAAuB,EAAvB;AACA,SAAKI,SAAL,GAAiBD,eAAe,CAACC,SAAjC;AACA,SAAKC,OAAL,GAAeF,eAAe,CAACG,MAA/B;AACH;;AACDC,EAAAA,QAAQ,GAAG,CACV;;AACDC,EAAAA,WAAW,CAACC,OAAD,EAAU;AACjB,QAAIC,EAAJ;;AACA,QAAI,CAACA,EAAE,GAAG,KAAKV,eAAX,MAAgC,IAAhC,IAAwCU,EAAE,KAAK,KAAK,CAApD,GAAwD,KAAK,CAA7D,GAAiEA,EAAE,CAAChB,MAAxE,EAAgF;AAC5E,WAAKiB,aAAL,GAAqB,KAAKC,OAAL,EAArB;AACH;AACJ;;AACDA,EAAAA,OAAO,GAAG;AACN,QAAIF,EAAJ;;AACA,QAAI,EAAE,CAACA,EAAE,GAAG,KAAKV,eAAX,MAAgC,IAAhC,IAAwCU,EAAE,KAAK,KAAK,CAApD,GAAwD,KAAK,CAA7D,GAAiEA,EAAE,CAAChB,MAAtE,CAAJ,EACI,OAAO/B,EAAE,CAAC;AAAEqB,MAAAA,KAAK,EAAE,EAAT;AAAasB,MAAAA,MAAM,EAAE;AAAEO,QAAAA,YAAY,EAAE,EAAhB;AAAoBC,QAAAA,GAAG,EAAE;AAAzB;AAArB,KAAD,CAAT;AACJ,WAAOpD,aAAa,CAAC,CAAC,KAAK0C,SAAN,EAAiB,KAAKC,OAAtB,CAAD,CAAb,CACFU,IADE,CACGnD,SAAS,CAAC,CAAC,CAACoB,KAAD,EAAQsB,MAAR,CAAD,KAAqB;AACrC,UAAI,CAACA,MAAM,CAACO,YAAZ,EAA0B;AACtB,YAAIG,MAAM,GAAG;AAAEhC,UAAAA,KAAK,EAAEA,KAAT;AAAgBsB,UAAAA;AAAhB,SAAb;AACA,eAAO3C,EAAE,CAACqD,MAAD,CAAT;AACH;;AACD,UAAIC,UAAU,GAAGjC,KAAK,CAACkC,MAAN,CAAaC,IAAI,IAAI;AAClC,YAAIT,EAAJ,EAAQU,EAAR;;AACA,YAAIC,SAAS,GAAG,CAACX,EAAE,GAAG,KAAKV,eAAX,MAAgC,IAAhC,IAAwCU,EAAE,KAAK,KAAK,CAApD,GAAwD,KAAK,CAA7D,GAAiEA,EAAE,CAACY,IAAH,CAAQC,KAAK,IAAIA,KAAK,CAACtC,OAAN,GAAgBuC,IAAhB,IAAwBL,IAAI,CAACM,MAA9C,CAAjF,CAFkC,CAGlC;;AACA,YAAIJ,SAAJ,EACI,OAAO,CAACD,EAAE,GAAGD,IAAI,CAACE,SAAS,CAACK,cAAV,EAAD,CAAV,MAA4C,IAA5C,IAAoDN,EAAE,KAAK,KAAK,CAAhE,GAAoE,KAAK,CAAzE,GAA6EA,EAAE,CAACO,QAAH,GAAcC,QAAd,CAAuBtB,MAAM,CAACO,YAA9B,CAApF;AACP,OANgB,CAAjB;AAOA,UAAIgB,cAAc,GAAG;AAAE7C,QAAAA,KAAK,EAAEsB,MAAM,CAACO,YAAP,CAAoBnB,MAApB,GAA6B,CAA7B,GAAiCuB,UAAjC,GAA8CjC,KAAvD;AAA8DsB,QAAAA;AAA9D,OAArB;AACA,aAAO3C,EAAE,CAACkE,cAAD,CAAT;AACH,KAdkB,CADZ,EAeHhE,GAAG,CAAC,CAAC;AAAEmB,MAAAA,KAAF;AAASsB,MAAAA;AAAT,KAAD,KAAuB;AAC3B,UAAII,EAAJ;;AACA,UAAI1B,KAAK,CAACU,MAAN,IAAgB,CAApB,EAAuB;AACnB,YAAIyB,IAAI,GAAGnC,KAAK,CAAC,CAAD,CAAhB;AACA,YAAIqC,SAAS,GAAG,CAACX,EAAE,GAAG,KAAKV,eAAX,MAAgC,IAAhC,IAAwCU,EAAE,KAAK,KAAK,CAApD,GAAwD,KAAK,CAA7D,GAAiEA,EAAE,CAACY,IAAH,CAAQC,KAAK,IAAIA,KAAK,CAACtC,OAAN,GAAgBuC,IAAhB,IAAwBL,IAAI,CAACM,MAA9C,CAAjF;;AACA,YAAIJ,SAAS,IAAIf,MAAM,CAACQ,GAAxB,EAA6B;AACzB,cAAIgB,YAAY,GAAG;AAAEC,YAAAA,QAAQ,EAAEZ,IAAI,CAACE,SAAS,CAACK,cAAV,EAAD,CAAhB;AAA8CP,YAAAA,IAAI,EAAEA;AAApD,WAAnB;AACA,eAAKhB,eAAL,CAAqB6B,UAArB,CAAgCF,YAAhC;AACH;AACJ;AACJ,KAVM,CAfA,CAAP;AA0BH;;AACD/C,EAAAA,cAAc,CAACkD,YAAD,EAAeC,IAAf,EAAqB;AAC/B,QAAI,EAAED,YAAY,KAAK,IAAjB,IAAyBA,YAAY,KAAK,KAAK,CAA/C,GAAmD,KAAK,CAAxD,GAA4DA,YAAY,CAACvC,MAA3E,CAAJ,EACI,OAAO,EAAP;AACJ,WAAOuC,YAAY,CACdf,MADE,CACKC,IAAI,IAAIA,IAAI,CAACM,MAAL,IAAeS,IAAI,CAACV,IADjC,CAAP;AAEH;;AAnDyC;;AAqD9CvB,gCAAgC,CAACkC,IAAjC,GAAwC,SAASC,wCAAT,CAAkDC,CAAlD,EAAqD;AAAE,SAAO,KAAKA,CAAC,IAAIpC,gCAAV,EAA4CnC,EAAE,CAACwE,iBAAH,CAAqBvE,EAAE,CAACwE,eAAxB,CAA5C,CAAP;AAA+F,CAA9L;;AACAtC,gCAAgC,CAACuC,IAAjC,GAAwC,aAAc1E,EAAE,CAAC2E,iBAAH,CAAqB;AAAEP,EAAAA,IAAI,EAAEjC,gCAAR;AAA0CyC,EAAAA,SAAS,EAAE,CAAC,CAAC,+BAAD,CAAD,CAArD;AAA0FC,EAAAA,MAAM,EAAE;AAAE3C,IAAAA,eAAe,EAAE,CAAC,QAAD,EAAW,iBAAX;AAAnB,GAAlG;AAAsJ4C,EAAAA,QAAQ,EAAE,CAAC9E,EAAE,CAAC+E,oBAAJ,CAAhK;AAA2LC,EAAAA,KAAK,EAAE,CAAlM;AAAqMC,EAAAA,IAAI,EAAE,CAA3M;AAA8MC,EAAAA,MAAM,EAAE,CAAC,CAAC,CAAD,EAAI,WAAJ,CAAD,EAAmB,CAAC,CAAD,EAAI,MAAJ,CAAnB,EAAgC,CAAC,CAAD,EAAI,OAAJ,EAAa,SAAb,CAAhC,EAAyD,CAAC,CAAD,EAAI,gBAAJ,EAAsB,UAAtB,EAAkC,CAAlC,EAAqC,MAArC,CAAzD,EAAuG,CAAC,CAAD,EAAI,gBAAJ,EAAsB,UAAtB,CAAvG,CAAtN;AAAiWC,EAAAA,QAAQ,EAAE,SAASC,yCAAT,CAAmD9E,EAAnD,EAAuDC,GAAvD,EAA4D;AAAE,QAAID,EAAE,GAAG,CAAT,EAAY;AACxfN,MAAAA,EAAE,CAACuB,cAAH,CAAkB,CAAlB,EAAqB,KAArB,EAA4B,CAA5B;AACAvB,MAAAA,EAAE,CAACwB,UAAH,CAAc,CAAd,EAAiBK,wDAAjB,EAA2E,CAA3E,EAA8E,CAA9E,EAAiF,cAAjF,EAAiG,CAAjG;AACA7B,MAAAA,EAAE,CAACqF,MAAH,CAAU,CAAV,EAAa,OAAb;AACArF,MAAAA,EAAE,CAACyB,YAAH;AACH;;AAAC,QAAInB,EAAE,GAAG,CAAT,EAAY;AACVN,MAAAA,EAAE,CAAC2B,SAAH,CAAa,CAAb;AACA3B,MAAAA,EAAE,CAACgB,UAAH,CAAc,MAAd,EAAsBhB,EAAE,CAACsF,WAAH,CAAe,CAAf,EAAkB,CAAlB,EAAqB/E,GAAG,CAACsC,aAAzB,CAAtB;AACH;AAAE,GARoE;AAQlE0C,EAAAA,UAAU,EAAE,CAACrF,EAAE,CAACsF,IAAJ,EAAUtF,EAAE,CAACuF,OAAb,EAAsBtF,EAAE,CAACuF,wBAAzB,CARsD;AAQFC,EAAAA,KAAK,EAAE,CAACzF,EAAE,CAAC0F,SAAJ,CARL;AAQqBC,EAAAA,MAAM,EAAE,CAAC,g7BAAD;AAR7B,CAArB,CAAtD","sourcesContent":["import { combineLatest, of } from \"rxjs\";\nimport { switchMap, tap, } from \"rxjs/operators\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../dropdown.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"../dropdown-segment/dropdown-segment.component\";\nconst _c0 = function () { return []; };\nfunction DropdownSegmentsWrapperComponent_ng_container_1_div_1_app_dropdown_segment_1_Template(rf, ctx) { if (rf & 1) {\n    i0.ɵɵelement(0, \"app-dropdown-segment\", 4);\n} if (rf & 2) {\n    const combo_r3 = i0.ɵɵnextContext().$implicit;\n    const filteredList_r1 = i0.ɵɵnextContext().ngIf;\n    const ctx_r4 = i0.ɵɵnextContext();\n    let tmp_1_0;\n    i0.ɵɵproperty(\"comboComponent\", combo_r3)(\"dataList\", (tmp_1_0 = ctx_r4.getItemsByType(filteredList_r1.items, combo_r3.getType())) !== null && tmp_1_0 !== undefined ? tmp_1_0 : i0.ɵɵpureFunction0(2, _c0));\n} }\nfunction DropdownSegmentsWrapperComponent_ng_container_1_div_1_Template(rf, ctx) { if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, DropdownSegmentsWrapperComponent_ng_container_1_div_1_app_dropdown_segment_1_Template, 1, 3, \"app-dropdown-segment\", 3);\n    i0.ɵɵelementEnd();\n} if (rf & 2) {\n    const combo_r3 = ctx.$implicit;\n    const filteredList_r1 = i0.ɵɵnextContext().ngIf;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.getItemsByType(filteredList_r1.items, combo_r3.getType()).length > 0);\n} }\nfunction DropdownSegmentsWrapperComponent_ng_container_1_Template(rf, ctx) { if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, DropdownSegmentsWrapperComponent_ng_container_1_div_1_Template, 2, 1, \"div\", 2);\n    i0.ɵɵelementContainerEnd();\n} if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    let tmp_0_0;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", (tmp_0_0 = ctx_r0.comboComponents) !== null && tmp_0_0 !== undefined ? tmp_0_0 : i0.ɵɵpureFunction0(1, _c0));\n} }\nexport class DropdownSegmentsWrapperComponent {\n    constructor(dropdownService) {\n        this.dropdownService = dropdownService;\n        this.comboComponents = [];\n        this.dataList$ = dropdownService.dataList$;\n        this.search$ = dropdownService.search;\n    }\n    ngOnInit() {\n    }\n    ngOnChanges(changes) {\n        var _a;\n        if ((_a = this.comboComponents) === null || _a === void 0 ? void 0 : _a.length) {\n            this.filteredList$ = this.getList();\n        }\n    }\n    getList() {\n        var _a;\n        if (!((_a = this.comboComponents) === null || _a === void 0 ? void 0 : _a.length))\n            return of({ items: [], search: { searchString: '', key: '' } });\n        return combineLatest([this.dataList$, this.search$])\n            .pipe(switchMap(([items, search]) => {\n            if (!search.searchString) {\n                let result = { items: items, search };\n                return of(result);\n            }\n            let filterList = items.filter(item => {\n                var _a, _b;\n                let comboComp = (_a = this.comboComponents) === null || _a === void 0 ? void 0 : _a.find(combo => combo.getType().name == item.__type);\n                // @ts-ignore\n                if (comboComp)\n                    return (_b = item[comboComp.getSelectValue()]) === null || _b === void 0 ? void 0 : _b.toString().includes(search.searchString);\n            });\n            let filteredResult = { items: search.searchString.length > 0 ? filterList : items, search };\n            return of(filteredResult);\n        }), tap(({ items, search }) => {\n            var _a;\n            if (items.length == 1) {\n                let item = items[0];\n                let comboComp = (_a = this.comboComponents) === null || _a === void 0 ? void 0 : _a.find(combo => combo.getType().name == item.__type);\n                if (comboComp && search.key) {\n                    let selectedItem = { inputStr: item[comboComp.getSelectValue()], item: item };\n                    this.dropdownService.selectItem(selectedItem);\n                }\n            }\n        }));\n    }\n    getItemsByType(filteredList, type) {\n        if (!(filteredList === null || filteredList === void 0 ? void 0 : filteredList.length))\n            return [];\n        return filteredList\n            .filter(item => item.__type == type.name);\n    }\n}\nDropdownSegmentsWrapperComponent.ɵfac = function DropdownSegmentsWrapperComponent_Factory(t) { return new (t || DropdownSegmentsWrapperComponent)(i0.ɵɵdirectiveInject(i1.DropdownService)); };\nDropdownSegmentsWrapperComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: DropdownSegmentsWrapperComponent, selectors: [[\"app-dropdown-segments-wrapper\"]], inputs: { comboComponents: [\"combos\", \"comboComponents\"] }, features: [i0.ɵɵNgOnChangesFeature], decls: 3, vars: 3, consts: [[1, \"container\"], [4, \"ngIf\"], [4, \"ngFor\", \"ngForOf\"], [3, \"comboComponent\", \"dataList\", 4, \"ngIf\"], [3, \"comboComponent\", \"dataList\"]], template: function DropdownSegmentsWrapperComponent_Template(rf, ctx) { if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵtemplate(1, DropdownSegmentsWrapperComponent_ng_container_1_Template, 2, 2, \"ng-container\", 1);\n        i0.ɵɵpipe(2, \"async\");\n        i0.ɵɵelementEnd();\n    } if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(2, 1, ctx.filteredList$));\n    } }, directives: [i2.NgIf, i2.NgForOf, i3.DropdownSegmentComponent], pipes: [i2.AsyncPipe], styles: [\".container[_ngcontent-%COMP%] {\\n  width: 350px;\\n  max-width: 550px;\\n  max-height: 500px;\\n  overflow-y: auto;\\n  box-shadow: 1px 1px 8px -1px rgba(128, 128, 128, 0.4);\\n  border-radius: 4px;\\n  position: relative;\\n  z-index: 20;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRyb3Bkb3duLXNlZ21lbnRzLXdyYXBwZXIuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLFlBQVk7RUFDWixnQkFBZ0I7RUFDaEIsaUJBQWlCO0VBQ2pCLGdCQUFnQjtFQUNoQixxREFBcUQ7RUFDckQsa0JBQWtCO0VBQ2xCLGtCQUFrQjtFQUNsQixXQUFXO0FBQ2IiLCJmaWxlIjoiZHJvcGRvd24tc2VnbWVudHMtd3JhcHBlci5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmNvbnRhaW5lciB7XG4gIHdpZHRoOiAzNTBweDtcbiAgbWF4LXdpZHRoOiA1NTBweDtcbiAgbWF4LWhlaWdodDogNTAwcHg7XG4gIG92ZXJmbG93LXk6IGF1dG87XG4gIGJveC1zaGFkb3c6IDFweCAxcHggOHB4IC0xcHggcmdiYSgxMjgsIDEyOCwgMTI4LCAwLjQpO1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgei1pbmRleDogMjA7XG59XG4iXX0= */\"] });\n"]},"metadata":{},"sourceType":"module"}