{"ast":null,"code":"import { ComboEntityDirective } from \"../combo-entity.directive\";\nimport { NG_VALIDATORS, NG_VALUE_ACCESSOR } from \"@angular/forms\";\nimport { DropdownService } from \"./dropdown.service\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./dropdown.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"./dropdown-segments-wrapper/dropdown-segments-wrapper.component\";\nconst _c0 = [\"input\"];\n\nfunction DropdownComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 6);\n    i0.ɵɵlistener(\"click\", function DropdownComponent_div_0_Template_div_click_0_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return ctx_r3.closeOptions();\n    });\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction DropdownComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelement(1, \"app-dropdown-segments-wrapper\", 7);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"combos\", ctx_r2.comboComponents);\n  }\n}\n\nexport class DropdownComponent {\n  constructor(dropdownService) {\n    this.dropdownService = dropdownService;\n    this.comboComponents = [];\n    this.inputStr = '';\n\n    this.onChange = value => {};\n\n    this.onTouched = () => {};\n\n    this.touched = false;\n    this.disabled = false; // cd.detach();\n\n    this.showOptions$ = dropdownService.showOptionsObs$;\n    dropdownService.selectedItem.subscribe(comboValue => {\n      this.setSelectedItem(comboValue);\n    });\n  }\n\n  ngAfterContentInit() {\n    var _a, _b;\n\n    this.comboComponents = (_a = this.children) === null || _a === void 0 ? void 0 : _a.filter(item => !!item.component).map(item => item.component);\n    (_b = this.comboComponents) === null || _b === void 0 ? void 0 : _b.forEach(item => {\n      this.dropdownService.loadDataByType(item.getType());\n    });\n\n    if (this.initialValue) {\n      let item = this.dropdownService.findItemByValue(this.initialValue, this.comboComponents);\n      this.setSelectedItem({\n        item: item,\n        inputStr: this.initialValue\n      });\n    }\n  }\n\n  setSelectedItem(selectedItem) {\n    this.markAsTouched();\n    this.onChange(selectedItem);\n    this.inputStr = selectedItem.inputStr;\n    this.dropdownService.closeOptions();\n  }\n\n  onInputChange(event) {\n    var _a, _b;\n\n    this.dropdownService.openOptions();\n    let inputStr = (_a = this.input) === null || _a === void 0 ? void 0 : _a.nativeElement.value;\n    this.dropdownService.setSearch({\n      searchString: inputStr !== null && inputStr !== void 0 ? inputStr : '',\n      key: (_b = event.data) !== null && _b !== void 0 ? _b : ''\n    });\n\n    if (!this.disabled) {// this.onChange(event); //TODO\n    }\n  }\n\n  closeOptions() {\n    this.dropdownService.closeOptions();\n  }\n\n  openOptions() {\n    this.dropdownService.openOptions();\n  }\n\n  clearInputStr() {\n    this.inputStr = '';\n  }\n\n  markAsTouched() {\n    if (!this.touched) {\n      this.onTouched();\n      this.touched = true;\n    }\n  }\n\n  registerOnChange(fn) {\n    this.onChange = fn;\n  }\n\n  registerOnTouched(fn) {\n    this.onTouched = fn;\n  }\n\n  validate(control) {\n    return null;\n  }\n\n  writeValue(value) {\n    this.initialValue = value;\n  }\n\n}\n\nDropdownComponent.ɵfac = function DropdownComponent_Factory(t) {\n  return new (t || DropdownComponent)(i0.ɵɵdirectiveInject(i1.DropdownService));\n};\n\nDropdownComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: DropdownComponent,\n  selectors: [[\"app-dropdown\"]],\n  contentQueries: function DropdownComponent_ContentQueries(rf, ctx, dirIndex) {\n    if (rf & 1) {\n      i0.ɵɵcontentQuery(dirIndex, ComboEntityDirective, 4);\n    }\n\n    if (rf & 2) {\n      let _t;\n\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.children = _t);\n    }\n  },\n  viewQuery: function DropdownComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n    }\n\n    if (rf & 2) {\n      let _t;\n\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.input = _t.first);\n    }\n  },\n  features: [i0.ɵɵProvidersFeature([{\n    provide: NG_VALUE_ACCESSOR,\n    multi: true,\n    useExisting: DropdownComponent\n  }, {\n    provide: NG_VALIDATORS,\n    multi: true,\n    useExisting: DropdownComponent\n  }, DropdownService])],\n  decls: 10,\n  vars: 7,\n  consts: [[\"class\", \"background\", 3, \"click\", 4, \"ngIf\"], [1, \"input-wrapper\"], [3, \"ngModel\", \"ngModelChange\", \"input\", \"click\"], [\"input\", \"\"], [3, \"click\"], [4, \"ngIf\"], [1, \"background\", 3, \"click\"], [1, \"segment-wrapper\", 3, \"combos\"]],\n  template: function DropdownComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, DropdownComponent_div_0_Template, 1, 0, \"div\", 0);\n      i0.ɵɵpipe(1, \"async\");\n      i0.ɵɵelementStart(2, \"div\")(3, \"div\", 1)(4, \"input\", 2, 3);\n      i0.ɵɵlistener(\"ngModelChange\", function DropdownComponent_Template_input_ngModelChange_4_listener($event) {\n        return ctx.inputStr = $event;\n      })(\"input\", function DropdownComponent_Template_input_input_4_listener($event) {\n        return ctx.onInputChange($event);\n      })(\"click\", function DropdownComponent_Template_input_click_4_listener() {\n        return ctx.openOptions();\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(6, \"button\", 4);\n      i0.ɵɵlistener(\"click\", function DropdownComponent_Template_button_click_6_listener() {\n        return ctx.clearInputStr();\n      });\n      i0.ɵɵtext(7, \"X\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵtemplate(8, DropdownComponent_div_8_Template, 2, 1, \"div\", 5);\n      i0.ɵɵpipe(9, \"async\");\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(1, 3, ctx.showOptions$));\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngModel\", ctx.inputStr);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(9, 5, ctx.showOptions$));\n    }\n  },\n  directives: [i2.NgIf, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgModel, i4.DropdownSegmentsWrapperComponent],\n  pipes: [i2.AsyncPipe],\n  styles: [\".input-wrapper[_ngcontent-%COMP%] {\\n  max-width: 250px;\\n  padding: 10px 15px;\\n  border-radius: 8px;\\n  border: 1px solid rgba(128, 128, 128, 0.2);\\n  display: flex;\\n  justify-content: space-between;\\n  align-items: center;\\n  position: relative;\\n  z-index: 20;\\n}\\n.input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%] {\\n  border: none;\\n  outline: none;\\n  padding: 0;\\n  margin: 0;\\n}\\n.input-wrapper[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\\n  -webkit-user-select: none;\\n          user-select: none;\\n  cursor: pointer;\\n  border: none;\\n  outline: none;\\n  background-color: transparent;\\n  font-size: 20px;\\n  font-weight: 500;\\n}\\n.input-wrapper[_ngcontent-%COMP%]:focus {\\n  box-shadow: 0 1px 1px 0 rgba(65, 69, 73, 0.3), 0 1px 3px 1px rgba(65, 69, 73, 0.15);\\n}\\n.input-wrapper[_ngcontent-%COMP%]:focus-within {\\n  box-shadow: 0 1px 1px 0 rgba(65, 69, 73, 0.3), 0 1px 3px 1px rgba(65, 69, 73, 0.15);\\n}\\n.segment-wrapper[_ngcontent-%COMP%] {\\n  position: absolute;\\n  z-index: 21;\\n}\\n.background[_ngcontent-%COMP%] {\\n  top: 0;\\n  left: 0;\\n  width: 100vw;\\n  height: 100vh;\\n  position: absolute;\\n  z-index: 20;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRyb3Bkb3duLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsZ0JBQUE7RUFDQSxrQkFBQTtFQUNBLGtCQUFBO0VBQ0EsMENBQUE7RUFDQSxhQUFBO0VBQ0EsOEJBQUE7RUFDQSxtQkFBQTtFQUNBLGtCQUFBO0VBQ0EsV0FBQTtBQUNGO0FBQUU7RUFFRSxZQUFBO0VBQ0EsYUFBQTtFQUNBLFVBQUE7RUFDQSxTQUFBO0FBQ0o7QUFDRTtFQUNFLHlCQUFBO1VBQUEsaUJBQUE7RUFDQSxlQUFBO0VBQ0EsWUFBQTtFQUNBLGFBQUE7RUFDQSw2QkFBQTtFQUNBLGVBQUE7RUFDQSxnQkFBQTtBQUNKO0FBQ0U7RUFDRSxtRkFBQTtBQUNKO0FBQ0U7RUFDRSxtRkFBQTtBQUNKO0FBRUE7RUFDRSxrQkFBQTtFQUNBLFdBQUE7QUFDRjtBQUNBO0VBQ0UsTUFBQTtFQUNBLE9BQUE7RUFDQSxZQUFBO0VBQ0EsYUFBQTtFQUNBLGtCQUFBO0VBQ0EsV0FBQTtBQUVGIiwiZmlsZSI6ImRyb3Bkb3duLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmlucHV0LXdyYXBwZXIge1xuICBtYXgtd2lkdGg6IDI1MHB4O1xuICBwYWRkaW5nOiAxMHB4IDE1cHg7XG4gIGJvcmRlci1yYWRpdXM6IDhweDtcbiAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgxMjgsIDEyOCwgMTI4LCAwLjIpO1xuICBkaXNwbGF5OiBmbGV4O1xuICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgei1pbmRleDogMjA7XG4gIGlucHV0IHtcbiAgICAvL2JvcmRlcjogMXB4IHNvbGlkIHJnYmEoMTI4LCAxMjgsIDEyOCwgMC4yKTtcbiAgICBib3JkZXI6IG5vbmU7XG4gICAgb3V0bGluZTogbm9uZTtcbiAgICBwYWRkaW5nOiAwO1xuICAgIG1hcmdpbjogMDtcbiAgfVxuICBidXR0b24ge1xuICAgIHVzZXItc2VsZWN0OiBub25lO1xuICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICBib3JkZXI6IG5vbmU7XG4gICAgb3V0bGluZTogbm9uZTtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDtcbiAgICBmb250LXNpemU6IDIwcHg7XG4gICAgZm9udC13ZWlnaHQ6IDUwMDtcbiAgfVxuICAmOmZvY3VzIHtcbiAgICBib3gtc2hhZG93OiAwIDFweCAxcHggMCByZ2JhKDY1LDY5LDczLC4zKSwwIDFweCAzcHggMXB4IHJnYmEoNjUsNjksNzMsLjE1KTtcbiAgfVxuICAmOmZvY3VzLXdpdGhpbiB7XG4gICAgYm94LXNoYWRvdzogMCAxcHggMXB4IDAgcmdiYSg2NSw2OSw3MywuMyksMCAxcHggM3B4IDFweCByZ2JhKDY1LDY5LDczLC4xNSk7XG4gIH1cbn1cbi5zZWdtZW50LXdyYXBwZXIge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHotaW5kZXg6IDIxO1xufVxuLmJhY2tncm91bmQge1xuICB0b3A6IDA7XG4gIGxlZnQ6IDA7XG4gIHdpZHRoOiAxMDB2dztcbiAgaGVpZ2h0OiAxMDB2aDtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICB6LWluZGV4OiAyMDtcbn1cblxuIl19 */\"],\n  changeDetection: 0\n});","map":{"version":3,"sources":["/Users/razearmin/Desktop/combo-dropdown/src/app/dropdown/dropdown.component.ts"],"names":["ComboEntityDirective","NG_VALIDATORS","NG_VALUE_ACCESSOR","DropdownService","i0","i1","i2","i3","i4","_c0","DropdownComponent_div_0_Template","rf","ctx","_r4","ɵɵgetCurrentView","ɵɵelementStart","ɵɵlistener","DropdownComponent_div_0_Template_div_click_0_listener","ɵɵrestoreView","ctx_r3","ɵɵnextContext","closeOptions","ɵɵelementEnd","DropdownComponent_div_8_Template","ɵɵelement","ctx_r2","ɵɵadvance","ɵɵproperty","comboComponents","DropdownComponent","constructor","dropdownService","inputStr","onChange","value","onTouched","touched","disabled","showOptions$","showOptionsObs$","selectedItem","subscribe","comboValue","setSelectedItem","ngAfterContentInit","_a","_b","children","filter","item","component","map","forEach","loadDataByType","getType","initialValue","findItemByValue","markAsTouched","onInputChange","event","openOptions","input","nativeElement","setSearch","searchString","key","data","clearInputStr","registerOnChange","fn","registerOnTouched","validate","control","writeValue","ɵfac","DropdownComponent_Factory","t","ɵɵdirectiveInject","ɵcmp","ɵɵdefineComponent","type","selectors","contentQueries","DropdownComponent_ContentQueries","dirIndex","ɵɵcontentQuery","_t","ɵɵqueryRefresh","ɵɵloadQuery","viewQuery","DropdownComponent_Query","ɵɵviewQuery","first","features","ɵɵProvidersFeature","provide","multi","useExisting","decls","vars","consts","template","DropdownComponent_Template","ɵɵtemplate","ɵɵpipe","DropdownComponent_Template_input_ngModelChange_4_listener","$event","DropdownComponent_Template_input_input_4_listener","DropdownComponent_Template_input_click_4_listener","DropdownComponent_Template_button_click_6_listener","ɵɵtext","ɵɵpipeBind1","directives","NgIf","DefaultValueAccessor","NgControlStatus","NgModel","DropdownSegmentsWrapperComponent","pipes","AsyncPipe","styles","changeDetection"],"mappings":"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","sourcesContent":["import { ComboEntityDirective } from \"../combo-entity.directive\";\nimport { NG_VALIDATORS, NG_VALUE_ACCESSOR } from \"@angular/forms\";\nimport { DropdownService } from \"./dropdown.service\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./dropdown.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"./dropdown-segments-wrapper/dropdown-segments-wrapper.component\";\nconst _c0 = [\"input\"];\nfunction DropdownComponent_div_0_Template(rf, ctx) { if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 6);\n    i0.ɵɵlistener(\"click\", function DropdownComponent_div_0_Template_div_click_0_listener() { i0.ɵɵrestoreView(_r4); const ctx_r3 = i0.ɵɵnextContext(); return ctx_r3.closeOptions(); });\n    i0.ɵɵelementEnd();\n} }\nfunction DropdownComponent_div_8_Template(rf, ctx) { if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelement(1, \"app-dropdown-segments-wrapper\", 7);\n    i0.ɵɵelementEnd();\n} if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"combos\", ctx_r2.comboComponents);\n} }\nexport class DropdownComponent {\n    constructor(dropdownService) {\n        this.dropdownService = dropdownService;\n        this.comboComponents = [];\n        this.inputStr = '';\n        this.onChange = (value) => { };\n        this.onTouched = () => { };\n        this.touched = false;\n        this.disabled = false;\n        // cd.detach();\n        this.showOptions$ = dropdownService.showOptionsObs$;\n        dropdownService.selectedItem.subscribe((comboValue) => {\n            this.setSelectedItem(comboValue);\n        });\n    }\n    ngAfterContentInit() {\n        var _a, _b;\n        this.comboComponents = (_a = this.children) === null || _a === void 0 ? void 0 : _a.filter(item => !!item.component).map(item => item.component);\n        (_b = this.comboComponents) === null || _b === void 0 ? void 0 : _b.forEach(item => {\n            this.dropdownService.loadDataByType(item.getType());\n        });\n        if (this.initialValue) {\n            let item = this.dropdownService.findItemByValue(this.initialValue, this.comboComponents);\n            this.setSelectedItem({ item: item, inputStr: this.initialValue });\n        }\n    }\n    setSelectedItem(selectedItem) {\n        this.markAsTouched();\n        this.onChange(selectedItem);\n        this.inputStr = selectedItem.inputStr;\n        this.dropdownService.closeOptions();\n    }\n    onInputChange(event) {\n        var _a, _b;\n        this.dropdownService.openOptions();\n        let inputStr = (_a = this.input) === null || _a === void 0 ? void 0 : _a.nativeElement.value;\n        this.dropdownService.setSearch({ searchString: inputStr !== null && inputStr !== void 0 ? inputStr : '', key: (_b = event.data) !== null && _b !== void 0 ? _b : '' });\n        if (!this.disabled) {\n            // this.onChange(event); //TODO\n        }\n    }\n    closeOptions() {\n        this.dropdownService.closeOptions();\n    }\n    openOptions() {\n        this.dropdownService.openOptions();\n    }\n    clearInputStr() {\n        this.inputStr = '';\n    }\n    markAsTouched() {\n        if (!this.touched) {\n            this.onTouched();\n            this.touched = true;\n        }\n    }\n    registerOnChange(fn) {\n        this.onChange = fn;\n    }\n    registerOnTouched(fn) {\n        this.onTouched = fn;\n    }\n    validate(control) {\n        return null;\n    }\n    writeValue(value) {\n        this.initialValue = value;\n    }\n}\nDropdownComponent.ɵfac = function DropdownComponent_Factory(t) { return new (t || DropdownComponent)(i0.ɵɵdirectiveInject(i1.DropdownService)); };\nDropdownComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: DropdownComponent, selectors: [[\"app-dropdown\"]], contentQueries: function DropdownComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {\n        i0.ɵɵcontentQuery(dirIndex, ComboEntityDirective, 4);\n    } if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.children = _t);\n    } }, viewQuery: function DropdownComponent_Query(rf, ctx) { if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n    } if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.input = _t.first);\n    } }, features: [i0.ɵɵProvidersFeature([\n            {\n                provide: NG_VALUE_ACCESSOR,\n                multi: true,\n                useExisting: DropdownComponent\n            },\n            {\n                provide: NG_VALIDATORS,\n                multi: true,\n                useExisting: DropdownComponent\n            },\n            DropdownService\n        ])], decls: 10, vars: 7, consts: [[\"class\", \"background\", 3, \"click\", 4, \"ngIf\"], [1, \"input-wrapper\"], [3, \"ngModel\", \"ngModelChange\", \"input\", \"click\"], [\"input\", \"\"], [3, \"click\"], [4, \"ngIf\"], [1, \"background\", 3, \"click\"], [1, \"segment-wrapper\", 3, \"combos\"]], template: function DropdownComponent_Template(rf, ctx) { if (rf & 1) {\n        i0.ɵɵtemplate(0, DropdownComponent_div_0_Template, 1, 0, \"div\", 0);\n        i0.ɵɵpipe(1, \"async\");\n        i0.ɵɵelementStart(2, \"div\")(3, \"div\", 1)(4, \"input\", 2, 3);\n        i0.ɵɵlistener(\"ngModelChange\", function DropdownComponent_Template_input_ngModelChange_4_listener($event) { return ctx.inputStr = $event; })(\"input\", function DropdownComponent_Template_input_input_4_listener($event) { return ctx.onInputChange($event); })(\"click\", function DropdownComponent_Template_input_click_4_listener() { return ctx.openOptions(); });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"button\", 4);\n        i0.ɵɵlistener(\"click\", function DropdownComponent_Template_button_click_6_listener() { return ctx.clearInputStr(); });\n        i0.ɵɵtext(7, \"X\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(8, DropdownComponent_div_8_Template, 2, 1, \"div\", 5);\n        i0.ɵɵpipe(9, \"async\");\n        i0.ɵɵelementEnd();\n    } if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(1, 3, ctx.showOptions$));\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.inputStr);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(9, 5, ctx.showOptions$));\n    } }, directives: [i2.NgIf, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgModel, i4.DropdownSegmentsWrapperComponent], pipes: [i2.AsyncPipe], styles: [\".input-wrapper[_ngcontent-%COMP%] {\\n  max-width: 250px;\\n  padding: 10px 15px;\\n  border-radius: 8px;\\n  border: 1px solid rgba(128, 128, 128, 0.2);\\n  display: flex;\\n  justify-content: space-between;\\n  align-items: center;\\n  position: relative;\\n  z-index: 20;\\n}\\n.input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%] {\\n  border: none;\\n  outline: none;\\n  padding: 0;\\n  margin: 0;\\n}\\n.input-wrapper[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\\n  -webkit-user-select: none;\\n          user-select: none;\\n  cursor: pointer;\\n  border: none;\\n  outline: none;\\n  background-color: transparent;\\n  font-size: 20px;\\n  font-weight: 500;\\n}\\n.input-wrapper[_ngcontent-%COMP%]:focus {\\n  box-shadow: 0 1px 1px 0 rgba(65, 69, 73, 0.3), 0 1px 3px 1px rgba(65, 69, 73, 0.15);\\n}\\n.input-wrapper[_ngcontent-%COMP%]:focus-within {\\n  box-shadow: 0 1px 1px 0 rgba(65, 69, 73, 0.3), 0 1px 3px 1px rgba(65, 69, 73, 0.15);\\n}\\n.segment-wrapper[_ngcontent-%COMP%] {\\n  position: absolute;\\n  z-index: 21;\\n}\\n.background[_ngcontent-%COMP%] {\\n  top: 0;\\n  left: 0;\\n  width: 100vw;\\n  height: 100vh;\\n  position: absolute;\\n  z-index: 20;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRyb3Bkb3duLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsZ0JBQUE7RUFDQSxrQkFBQTtFQUNBLGtCQUFBO0VBQ0EsMENBQUE7RUFDQSxhQUFBO0VBQ0EsOEJBQUE7RUFDQSxtQkFBQTtFQUNBLGtCQUFBO0VBQ0EsV0FBQTtBQUNGO0FBQUU7RUFFRSxZQUFBO0VBQ0EsYUFBQTtFQUNBLFVBQUE7RUFDQSxTQUFBO0FBQ0o7QUFDRTtFQUNFLHlCQUFBO1VBQUEsaUJBQUE7RUFDQSxlQUFBO0VBQ0EsWUFBQTtFQUNBLGFBQUE7RUFDQSw2QkFBQTtFQUNBLGVBQUE7RUFDQSxnQkFBQTtBQUNKO0FBQ0U7RUFDRSxtRkFBQTtBQUNKO0FBQ0U7RUFDRSxtRkFBQTtBQUNKO0FBRUE7RUFDRSxrQkFBQTtFQUNBLFdBQUE7QUFDRjtBQUNBO0VBQ0UsTUFBQTtFQUNBLE9BQUE7RUFDQSxZQUFBO0VBQ0EsYUFBQTtFQUNBLGtCQUFBO0VBQ0EsV0FBQTtBQUVGIiwiZmlsZSI6ImRyb3Bkb3duLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmlucHV0LXdyYXBwZXIge1xuICBtYXgtd2lkdGg6IDI1MHB4O1xuICBwYWRkaW5nOiAxMHB4IDE1cHg7XG4gIGJvcmRlci1yYWRpdXM6IDhweDtcbiAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgxMjgsIDEyOCwgMTI4LCAwLjIpO1xuICBkaXNwbGF5OiBmbGV4O1xuICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgei1pbmRleDogMjA7XG4gIGlucHV0IHtcbiAgICAvL2JvcmRlcjogMXB4IHNvbGlkIHJnYmEoMTI4LCAxMjgsIDEyOCwgMC4yKTtcbiAgICBib3JkZXI6IG5vbmU7XG4gICAgb3V0bGluZTogbm9uZTtcbiAgICBwYWRkaW5nOiAwO1xuICAgIG1hcmdpbjogMDtcbiAgfVxuICBidXR0b24ge1xuICAgIHVzZXItc2VsZWN0OiBub25lO1xuICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICBib3JkZXI6IG5vbmU7XG4gICAgb3V0bGluZTogbm9uZTtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDtcbiAgICBmb250LXNpemU6IDIwcHg7XG4gICAgZm9udC13ZWlnaHQ6IDUwMDtcbiAgfVxuICAmOmZvY3VzIHtcbiAgICBib3gtc2hhZG93OiAwIDFweCAxcHggMCByZ2JhKDY1LDY5LDczLC4zKSwwIDFweCAzcHggMXB4IHJnYmEoNjUsNjksNzMsLjE1KTtcbiAgfVxuICAmOmZvY3VzLXdpdGhpbiB7XG4gICAgYm94LXNoYWRvdzogMCAxcHggMXB4IDAgcmdiYSg2NSw2OSw3MywuMyksMCAxcHggM3B4IDFweCByZ2JhKDY1LDY5LDczLC4xNSk7XG4gIH1cbn1cbi5zZWdtZW50LXdyYXBwZXIge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHotaW5kZXg6IDIxO1xufVxuLmJhY2tncm91bmQge1xuICB0b3A6IDA7XG4gIGxlZnQ6IDA7XG4gIHdpZHRoOiAxMDB2dztcbiAgaGVpZ2h0OiAxMDB2aDtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICB6LWluZGV4OiAyMDtcbn1cblxuIl19 */\"], changeDetection: 0 });\n"]},"metadata":{},"sourceType":"module"}