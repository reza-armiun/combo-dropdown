{"ast":null,"code":"import { combineLatest, of } from \"rxjs\";\nimport { switchMap, tap } from \"rxjs/operators\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../dropdown.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"../dropdown-segment/dropdown-segment.component\";\n\nfunction DropdownSegmentsWrapperComponent_ng_container_1_div_1_ng_container_1_app_dropdown_segment_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-dropdown-segment\", 4);\n  }\n\n  if (rf & 2) {\n    const items_r5 = i0.ɵɵnextContext().ngIf;\n    const combo_r3 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"comboComponent\", combo_r3)(\"dataList\", items_r5);\n  }\n}\n\nfunction DropdownSegmentsWrapperComponent_ng_container_1_div_1_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, DropdownSegmentsWrapperComponent_ng_container_1_div_1_ng_container_1_app_dropdown_segment_1_Template, 1, 2, \"app-dropdown-segment\", 3);\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const items_r5 = ctx.ngIf;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", items_r5.length > 0);\n  }\n}\n\nfunction DropdownSegmentsWrapperComponent_ng_container_1_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, DropdownSegmentsWrapperComponent_ng_container_1_div_1_ng_container_1_Template, 2, 1, \"ng-container\", 1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const combo_r3 = ctx.$implicit;\n    const filteredList_r1 = i0.ɵɵnextContext().ngIf;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.getItemsByType(filteredList_r1.items, combo_r3.getType()));\n  }\n}\n\nconst _c0 = function () {\n  return [];\n};\n\nfunction DropdownSegmentsWrapperComponent_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, DropdownSegmentsWrapperComponent_ng_container_1_div_1_Template, 2, 1, \"div\", 2);\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    let tmp_0_0;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", (tmp_0_0 = ctx_r0.comboComponents) !== null && tmp_0_0 !== undefined ? tmp_0_0 : i0.ɵɵpureFunction0(1, _c0));\n  }\n}\n\nexport class DropdownSegmentsWrapperComponent {\n  constructor(dropdownService) {\n    this.dropdownService = dropdownService;\n    this.comboComponents = [];\n    this.dataList$ = dropdownService.dataList$;\n    this.search$ = dropdownService.search;\n  }\n\n  ngOnInit() {}\n\n  ngOnChanges(changes) {\n    var _a;\n\n    if ((_a = this.comboComponents) === null || _a === void 0 ? void 0 : _a.length) {\n      this.filteredList$ = this.getList();\n    }\n  }\n\n  getList() {\n    var _a;\n\n    if (!((_a = this.comboComponents) === null || _a === void 0 ? void 0 : _a.length)) return of({\n      items: [],\n      search: {\n        searchString: '',\n        key: ''\n      }\n    });\n    return combineLatest([this.dataList$, this.search$]).pipe(switchMap(([items, search]) => {\n      if (!search.searchString) {\n        let result = {\n          items: items,\n          search\n        };\n        return of(result);\n      }\n\n      let filterList = items.filter(item => {\n        var _a, _b;\n\n        let comboComp = (_a = this.comboComponents) === null || _a === void 0 ? void 0 : _a.find(combo => combo.getType().name == item.__type); // @ts-ignore\n\n        if (comboComp) return (_b = item[comboComp.getSelectValue()]) === null || _b === void 0 ? void 0 : _b.toString().includes(search.searchString);\n      });\n      let filteredResult = {\n        items: search.searchString.length > 0 ? filterList : items,\n        search\n      };\n      return of(filteredResult);\n    }), tap(({\n      items,\n      search\n    }) => {\n      var _a;\n\n      if (items.length == 1) {\n        let item = items[0];\n        let comboComp = (_a = this.comboComponents) === null || _a === void 0 ? void 0 : _a.find(combo => combo.getType().name == item.__type);\n\n        if (comboComp && search.key) {\n          let selectedItem = {\n            inputStr: item[comboComp.getSelectValue()],\n            item: item\n          };\n          this.dropdownService.selectItem(selectedItem);\n        }\n      } else {\n        this.dropdownService.selectItem({\n          item: null,\n          inputStr: ''\n        });\n      }\n    }));\n  }\n\n  getItemsByType(filteredList, type) {\n    if (!(filteredList === null || filteredList === void 0 ? void 0 : filteredList.length)) return [];\n    return filteredList.filter(item => item.__type == type.name);\n  }\n\n}\n\nDropdownSegmentsWrapperComponent.ɵfac = function DropdownSegmentsWrapperComponent_Factory(t) {\n  return new (t || DropdownSegmentsWrapperComponent)(i0.ɵɵdirectiveInject(i1.DropdownService));\n};\n\nDropdownSegmentsWrapperComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: DropdownSegmentsWrapperComponent,\n  selectors: [[\"app-dropdown-segments-wrapper\"]],\n  inputs: {\n    comboComponents: [\"combos\", \"comboComponents\"]\n  },\n  features: [i0.ɵɵNgOnChangesFeature],\n  decls: 3,\n  vars: 3,\n  consts: [[1, \"container\"], [4, \"ngIf\"], [4, \"ngFor\", \"ngForOf\"], [3, \"comboComponent\", \"dataList\", 4, \"ngIf\"], [3, \"comboComponent\", \"dataList\"]],\n  template: function DropdownSegmentsWrapperComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵtemplate(1, DropdownSegmentsWrapperComponent_ng_container_1_Template, 2, 2, \"ng-container\", 1);\n      i0.ɵɵpipe(2, \"async\");\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(2, 1, ctx.filteredList$));\n    }\n  },\n  directives: [i2.NgIf, i2.NgForOf, i3.DropdownSegmentComponent],\n  pipes: [i2.AsyncPipe],\n  styles: [\".container[_ngcontent-%COMP%] {\\n  width: 350px;\\n  max-width: 550px;\\n  max-height: 500px;\\n  overflow-y: auto;\\n  box-shadow: 1px 1px 8px -1px rgba(128, 128, 128, 0.4);\\n  border-radius: 4px;\\n  position: relative;\\n  z-index: 20;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRyb3Bkb3duLXNlZ21lbnRzLXdyYXBwZXIuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLFlBQVk7RUFDWixnQkFBZ0I7RUFDaEIsaUJBQWlCO0VBQ2pCLGdCQUFnQjtFQUNoQixxREFBcUQ7RUFDckQsa0JBQWtCO0VBQ2xCLGtCQUFrQjtFQUNsQixXQUFXO0FBQ2IiLCJmaWxlIjoiZHJvcGRvd24tc2VnbWVudHMtd3JhcHBlci5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmNvbnRhaW5lciB7XG4gIHdpZHRoOiAzNTBweDtcbiAgbWF4LXdpZHRoOiA1NTBweDtcbiAgbWF4LWhlaWdodDogNTAwcHg7XG4gIG92ZXJmbG93LXk6IGF1dG87XG4gIGJveC1zaGFkb3c6IDFweCAxcHggOHB4IC0xcHggcmdiYSgxMjgsIDEyOCwgMTI4LCAwLjQpO1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgei1pbmRleDogMjA7XG59XG4iXX0= */\"]\n});","map":{"version":3,"sources":["/Users/razearmin/Desktop/combo-dropdown/src/app/dropdown/dropdown-segments-wrapper/dropdown-segments-wrapper.component.ts"],"names":["combineLatest","of","switchMap","tap","i0","i1","i2","i3","DropdownSegmentsWrapperComponent_ng_container_1_div_1_ng_container_1_app_dropdown_segment_1_Template","rf","ctx","ɵɵelement","items_r5","ɵɵnextContext","ngIf","combo_r3","$implicit","ɵɵproperty","DropdownSegmentsWrapperComponent_ng_container_1_div_1_ng_container_1_Template","ɵɵelementContainerStart","ɵɵtemplate","ɵɵelementContainerEnd","ɵɵadvance","length","DropdownSegmentsWrapperComponent_ng_container_1_div_1_Template","ɵɵelementStart","ɵɵelementEnd","filteredList_r1","ctx_r2","getItemsByType","items","getType","_c0","DropdownSegmentsWrapperComponent_ng_container_1_Template","ctx_r0","tmp_0_0","comboComponents","undefined","ɵɵpureFunction0","DropdownSegmentsWrapperComponent","constructor","dropdownService","dataList$","search$","search","ngOnInit","ngOnChanges","changes","_a","filteredList$","getList","searchString","key","pipe","result","filterList","filter","item","_b","comboComp","find","combo","name","__type","getSelectValue","toString","includes","filteredResult","selectedItem","inputStr","selectItem","filteredList","type","ɵfac","DropdownSegmentsWrapperComponent_Factory","t","ɵɵdirectiveInject","DropdownService","ɵcmp","ɵɵdefineComponent","selectors","inputs","features","ɵɵNgOnChangesFeature","decls","vars","consts","template","DropdownSegmentsWrapperComponent_Template","ɵɵpipe","ɵɵpipeBind1","directives","NgIf","NgForOf","DropdownSegmentComponent","pipes","AsyncPipe","styles"],"mappings":"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","sourcesContent":["import { combineLatest, of } from \"rxjs\";\nimport { switchMap, tap, } from \"rxjs/operators\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../dropdown.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"../dropdown-segment/dropdown-segment.component\";\nfunction DropdownSegmentsWrapperComponent_ng_container_1_div_1_ng_container_1_app_dropdown_segment_1_Template(rf, ctx) { if (rf & 1) {\n    i0.ɵɵelement(0, \"app-dropdown-segment\", 4);\n} if (rf & 2) {\n    const items_r5 = i0.ɵɵnextContext().ngIf;\n    const combo_r3 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"comboComponent\", combo_r3)(\"dataList\", items_r5);\n} }\nfunction DropdownSegmentsWrapperComponent_ng_container_1_div_1_ng_container_1_Template(rf, ctx) { if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, DropdownSegmentsWrapperComponent_ng_container_1_div_1_ng_container_1_app_dropdown_segment_1_Template, 1, 2, \"app-dropdown-segment\", 3);\n    i0.ɵɵelementContainerEnd();\n} if (rf & 2) {\n    const items_r5 = ctx.ngIf;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", items_r5.length > 0);\n} }\nfunction DropdownSegmentsWrapperComponent_ng_container_1_div_1_Template(rf, ctx) { if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, DropdownSegmentsWrapperComponent_ng_container_1_div_1_ng_container_1_Template, 2, 1, \"ng-container\", 1);\n    i0.ɵɵelementEnd();\n} if (rf & 2) {\n    const combo_r3 = ctx.$implicit;\n    const filteredList_r1 = i0.ɵɵnextContext().ngIf;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.getItemsByType(filteredList_r1.items, combo_r3.getType()));\n} }\nconst _c0 = function () { return []; };\nfunction DropdownSegmentsWrapperComponent_ng_container_1_Template(rf, ctx) { if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, DropdownSegmentsWrapperComponent_ng_container_1_div_1_Template, 2, 1, \"div\", 2);\n    i0.ɵɵelementContainerEnd();\n} if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    let tmp_0_0;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", (tmp_0_0 = ctx_r0.comboComponents) !== null && tmp_0_0 !== undefined ? tmp_0_0 : i0.ɵɵpureFunction0(1, _c0));\n} }\nexport class DropdownSegmentsWrapperComponent {\n    constructor(dropdownService) {\n        this.dropdownService = dropdownService;\n        this.comboComponents = [];\n        this.dataList$ = dropdownService.dataList$;\n        this.search$ = dropdownService.search;\n    }\n    ngOnInit() {\n    }\n    ngOnChanges(changes) {\n        var _a;\n        if ((_a = this.comboComponents) === null || _a === void 0 ? void 0 : _a.length) {\n            this.filteredList$ = this.getList();\n        }\n    }\n    getList() {\n        var _a;\n        if (!((_a = this.comboComponents) === null || _a === void 0 ? void 0 : _a.length))\n            return of({ items: [], search: { searchString: '', key: '' } });\n        return combineLatest([this.dataList$, this.search$])\n            .pipe(switchMap(([items, search]) => {\n            if (!search.searchString) {\n                let result = { items: items, search };\n                return of(result);\n            }\n            let filterList = items.filter(item => {\n                var _a, _b;\n                let comboComp = (_a = this.comboComponents) === null || _a === void 0 ? void 0 : _a.find(combo => combo.getType().name == item.__type);\n                // @ts-ignore\n                if (comboComp)\n                    return (_b = item[comboComp.getSelectValue()]) === null || _b === void 0 ? void 0 : _b.toString().includes(search.searchString);\n            });\n            let filteredResult = { items: search.searchString.length > 0 ? filterList : items, search };\n            return of(filteredResult);\n        }), tap(({ items, search }) => {\n            var _a;\n            if (items.length == 1) {\n                let item = items[0];\n                let comboComp = (_a = this.comboComponents) === null || _a === void 0 ? void 0 : _a.find(combo => combo.getType().name == item.__type);\n                if (comboComp && search.key) {\n                    let selectedItem = { inputStr: item[comboComp.getSelectValue()], item: item };\n                    this.dropdownService.selectItem(selectedItem);\n                }\n            }\n            else {\n                this.dropdownService.selectItem({ item: null, inputStr: '' });\n            }\n        }));\n    }\n    getItemsByType(filteredList, type) {\n        if (!(filteredList === null || filteredList === void 0 ? void 0 : filteredList.length))\n            return [];\n        return filteredList\n            .filter(item => item.__type == type.name);\n    }\n}\nDropdownSegmentsWrapperComponent.ɵfac = function DropdownSegmentsWrapperComponent_Factory(t) { return new (t || DropdownSegmentsWrapperComponent)(i0.ɵɵdirectiveInject(i1.DropdownService)); };\nDropdownSegmentsWrapperComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: DropdownSegmentsWrapperComponent, selectors: [[\"app-dropdown-segments-wrapper\"]], inputs: { comboComponents: [\"combos\", \"comboComponents\"] }, features: [i0.ɵɵNgOnChangesFeature], decls: 3, vars: 3, consts: [[1, \"container\"], [4, \"ngIf\"], [4, \"ngFor\", \"ngForOf\"], [3, \"comboComponent\", \"dataList\", 4, \"ngIf\"], [3, \"comboComponent\", \"dataList\"]], template: function DropdownSegmentsWrapperComponent_Template(rf, ctx) { if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵtemplate(1, DropdownSegmentsWrapperComponent_ng_container_1_Template, 2, 2, \"ng-container\", 1);\n        i0.ɵɵpipe(2, \"async\");\n        i0.ɵɵelementEnd();\n    } if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(2, 1, ctx.filteredList$));\n    } }, directives: [i2.NgIf, i2.NgForOf, i3.DropdownSegmentComponent], pipes: [i2.AsyncPipe], styles: [\".container[_ngcontent-%COMP%] {\\n  width: 350px;\\n  max-width: 550px;\\n  max-height: 500px;\\n  overflow-y: auto;\\n  box-shadow: 1px 1px 8px -1px rgba(128, 128, 128, 0.4);\\n  border-radius: 4px;\\n  position: relative;\\n  z-index: 20;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRyb3Bkb3duLXNlZ21lbnRzLXdyYXBwZXIuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLFlBQVk7RUFDWixnQkFBZ0I7RUFDaEIsaUJBQWlCO0VBQ2pCLGdCQUFnQjtFQUNoQixxREFBcUQ7RUFDckQsa0JBQWtCO0VBQ2xCLGtCQUFrQjtFQUNsQixXQUFXO0FBQ2IiLCJmaWxlIjoiZHJvcGRvd24tc2VnbWVudHMtd3JhcHBlci5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmNvbnRhaW5lciB7XG4gIHdpZHRoOiAzNTBweDtcbiAgbWF4LXdpZHRoOiA1NTBweDtcbiAgbWF4LWhlaWdodDogNTAwcHg7XG4gIG92ZXJmbG93LXk6IGF1dG87XG4gIGJveC1zaGFkb3c6IDFweCAxcHggOHB4IC0xcHggcmdiYSgxMjgsIDEyOCwgMTI4LCAwLjQpO1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgei1pbmRleDogMjA7XG59XG4iXX0= */\"] });\n"]},"metadata":{},"sourceType":"module"}